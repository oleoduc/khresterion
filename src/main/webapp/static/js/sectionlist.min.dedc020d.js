var mprogress=angular.module("modProgress",["mm.foundation"]);mprogress.factory("progressService",["$interval",function(a){"use strict";var b;return b={promise:{},start:function(b,c,d,e,f){b.pvalue=0,this.promise=a(function(){b.pvalue+e>100?(b.pvalue=0,b.firstMessage=f):b.pvalue=b.pvalue+e},c,d)},stop:function(b){a.cancel(this.promise),b.pvalue=100}}}]),mprogress.controller("CoProgressController",["$scope","progressService",function(a,b){"use strict";var c,d;d=this,(c=function(c,e,f,g){d.pvalue=c,a.$on(d.startEvent,function(a,c){b.start(d,e,f,g,d.secondMessage)}),a.$on(d.endEvent,function(a,c){b.stop(d)})})(2,200,100,2)}]),mprogress.directive("coProgress",[function(){"use strict";return{priority:0,restrict:"EA",replace:!0,transclude:!0,template:'<div ng-show="pro.isSaving"><div class="progresslayer"></div><div class="barlayer"><span>{{pro.firstMessage}} {{pro.pvalue}}%</span><div><div progressbar value="pro.pvalue" type="pro.type"><span class="meter">{{pro.pvalue}}%</span></div></div></div></div>',controller:"CoProgressController",controllerAs:"pro",bindToController:!0,scope:{pvalue:"@pvalue",type:"@type",firstMessage:"@",secondMessage:"@",startEvent:"@startEvent",endEvent:"@endEvent",isSaving:"="}}}]);var modSpinner=angular.module("modSpinner",[]);modSpinner.directive("coSpinner",[function(){"use strict";return{priority:0,restrict:"EA",replace:!0,transclude:!1,template:'<div ng-show="isLoading"><div class="spinner spinner-bar"></div></div>',scope:{isLoading:"="}}}]),angular.module("dueApp",["ngRoute","mm.foundation","modEtude","modProgress"]).config(["$routeProvider","$locationProvider",function(a,b){b.html5Mode(!1)}]);var modEtude=angular.module("modEtude",[]);modEtude.controller("SectionListController",["$scope","$window","$http","$rootScope",function(a,b,c,d){"use strict";a.entityList=[],a.sectionList=[],a.isSearching=!1,a.param={selected:{id:0,typeId:"Ontologie1_00Entete"}};var e,f,g;f=document.getElementsByTagName("base")[0].href,e=function(){a.isSearching=!0,c.get(f+"section/",{headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Expires:0},timeout:0,cache:!1}).success(function(b,c,d,e){a.sectionList=_.sortBy(b,function(a){return a.name}),a.isSearching=!1}).error(function(b,c,d,e){console.log(b),a.isSearching=!1})},g=function(){c.get(f+"section/names",{headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Expires:0},timeout:0,cache:!1}).success(function(b,c,d,e){var f;a.entityList=[],f=_.sortBy(_.filter(b,function(a){return"Ontologie1_Document"!==a&&"Ontologie1_DocumentDUE0"!==a&&"Ontologie1_DUE"!==a&&"Ontologie1_Titre"!==a&&"Ontologie1_Terme"!==a}),function(a){return a.toUpperCase()}),a.entityList=_.map(f,function(a,b){return{id:b,typeId:a}})}).error(function(a,b,c,d){console.log(a)})},a.createSection=function(b){a.isSearching=!0,c.post(f+"section",$.param({type_id:void 0===b?null:b.typeId}),{headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache",Expires:0},timeout:0,cache:!1}).success(function(b,c,d,f){0==b?(alert("Erreur creation"),a.isSearching=!1):e()}).error(function(b,c,d,e){console.log(b),a.isSearching=!1})},g(),e()}]);